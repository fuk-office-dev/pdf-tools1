<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDFä¸€æ‹¬ãƒªãƒãƒ¼ãƒ ãƒ„ãƒ¼ãƒ«</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f5f5f5;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 10px;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
        }

        .upload-area {
            border: 3px dashed #ccc;
            border-radius: 10px;
            padding: 40px;
            text-align: center;
            margin-bottom: 30px;
            background-color: #fff;
            transition: all 0.3s ease;
        }

        .upload-area:hover {
            border-color: #007bff;
            background-color: #f0f8ff;
        }

        .upload-area.dragover {
            border-color: #007bff;
            background-color: #e6f2ff;
        }

        .file-input-label {
            display: inline-block;
            padding: 12px 30px;
            background-color: #007bff;
            color: white;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s ease;
        }

        .file-input-label:hover {
            background-color: #0056b3;
        }

        input[type="file"] {
            display: none;
        }

        .settings-section {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: none;
        }

        .settings-section h3 {
            margin-bottom: 15px;
            color: #333;
        }

        .setting-group {
            margin-bottom: 20px;
        }

        .setting-group label {
            display: block;
            margin-bottom: 8px;
            color: #555;
            font-weight: 500;
        }

        .setting-group input[type="text"],
        .setting-group input[type="number"],
        .setting-group select {
            width: 100%;
            max-width: 400px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }

        .example {
            margin-top: 5px;
            padding: 8px;
            background: #f8f9fa;
            border-left: 3px solid #007bff;
            font-size: 13px;
            color: #666;
        }

        .file-list {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: none;
        }

        .file-list h3 {
            margin-bottom: 15px;
            color: #333;
        }

        .file-item {
            display: flex;
            align-items: center;
            padding: 12px;
            margin-bottom: 10px;
            background: #f8f9fa;
            border-radius: 5px;
            gap: 15px;
        }

        .file-number {
            font-weight: bold;
            color: #007bff;
            min-width: 30px;
        }

        .file-names {
            flex: 1;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .original-name {
            flex: 1;
            color: #666;
            text-decoration: line-through;
        }

        .arrow {
            color: #28a745;
            font-weight: bold;
        }

        .new-name {
            flex: 1;
            color: #28a745;
            font-weight: 500;
        }

        .file-size {
            color: #999;
            font-size: 13px;
            min-width: 80px;
            text-align: right;
        }

        .move-buttons {
            display: flex;
            gap: 5px;
        }

        .move-button {
            padding: 5px 10px;
            background: #6c757d;
            color: white;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
        }

        .move-button:hover {
            background: #5a6268;
        }

        .move-button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .action-button {
            padding: 12px 30px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
        }

        .action-button.primary {
            background: #28a745;
            color: white;
        }

        .action-button.primary:hover {
            background: #218838;
        }

        .action-button.secondary {
            background: #6c757d;
            color: white;
        }

        .action-button.secondary:hover {
            background: #5a6268;
        }

        .info-box {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            color: #0c5460;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }

        .pattern-options {
            display: none;
            margin-top: 10px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 5px;
        }

        .pattern-options.active {
            display: block;
        }

        .radio-group {
            margin-bottom: 10px;
        }

        .radio-group input[type="radio"] {
            margin-right: 8px;
        }

        .custom-pattern {
            display: none;
            margin-top: 10px;
        }

        .custom-pattern.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>PDFä¸€æ‹¬ãƒªãƒãƒ¼ãƒ ãƒ„ãƒ¼ãƒ«</h1>
        <p class="subtitle">è¤‡æ•°ã®PDFãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¸€æ‹¬ã§ãƒªãƒãƒ¼ãƒ ã§ãã¾ã™ã€‚é †ç•ªã®å…¥ã‚Œæ›¿ãˆã‚‚å¯èƒ½ã§ã™ã€‚</p>

        <div class="upload-area" id="uploadArea">
            <p style="font-size: 18px; color: #666; margin-bottom: 15px;">
                ğŸ“„ PDFãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—<br>ã¾ãŸã¯
            </p>
            <label for="pdfFiles" class="file-input-label">
                ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠï¼ˆè¤‡æ•°å¯ï¼‰
            </label>
            <input type="file" id="pdfFiles" accept=".pdf" multiple>
            <p style="font-size: 14px; color: #999; margin-top: 15px;">
                â€» è¤‡æ•°ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¸€åº¦ã«é¸æŠã§ãã¾ã™ï¼ˆ30å€‹ã¾ã§æ¨å¥¨ï¼‰
            </p>
        </div>

        <div class="settings-section" id="settingsSection">
            <h3>âš™ï¸ ãƒªãƒãƒ¼ãƒ è¨­å®š</h3>
            
            <div class="setting-group">
                <label>ãƒªãƒãƒ¼ãƒ æ–¹æ³•</label>
                <select id="renameMethod">
                    <option value="simple">ã‚·ãƒ³ãƒ—ãƒ«ç•ªå· (1, 2, 3...)</option>
                    <option value="prefix">ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ + ç•ªå·</option>
                    <option value="pattern">ã‚«ã‚¹ã‚¿ãƒ ãƒ‘ã‚¿ãƒ¼ãƒ³</option>
                </select>
            </div>

            <div id="prefixOptions" class="pattern-options">
                <div class="setting-group">
                    <label>ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ï¼ˆæ¥é ­è¾ï¼‰</label>
                    <input type="text" id="prefix" placeholder="ä¾‹: è«‹æ±‚æ›¸_">
                    <div class="example">
                        ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼: <strong id="prefixPreview">è«‹æ±‚æ›¸_1.pdf, è«‹æ±‚æ›¸_2.pdf, è«‹æ±‚æ›¸_3.pdf...</strong>
                    </div>
                </div>
            </div>

            <div id="patternOptions" class="pattern-options">
                <div class="setting-group">
                    <label>ã‚«ã‚¹ã‚¿ãƒ ãƒ‘ã‚¿ãƒ¼ãƒ³</label>
                    <input type="text" id="customPattern" placeholder="ä¾‹: {year}å¹´åº¦_{name}_{num}">
                    <div style="font-size: 13px; color: #666; margin-top: 5px;">
                        ä½¿ç”¨å¯èƒ½ãªå¤‰æ•°:<br>
                        {num} = é€£ç•ª, {name} = ä»»æ„ã®åå‰, {year} = å¹´, {month} = æœˆ, {date} = æ—¥ä»˜
                    </div>
                    <div class="example">
                        ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼: <strong id="patternPreview"></strong>
                    </div>
                </div>

                <div class="setting-group">
                    <label>{name}ã®å€¤ï¼ˆã‚«ã‚¹ã‚¿ãƒ ãƒ‘ã‚¿ãƒ¼ãƒ³ã§{name}ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆï¼‰</label>
                    <input type="text" id="customName" placeholder="ä¾‹: å¥‘ç´„æ›¸">
                </div>
            </div>

            <div class="setting-group">
                <label>é–‹å§‹ç•ªå·</label>
                <input type="number" id="startNumber" value="1" min="0">
                <div style="font-size: 13px; color: #666; margin-top: 5px;">
                    é€£ç•ªã®é–‹å§‹ç•ªå·ã‚’æŒ‡å®šï¼ˆé€šå¸¸ã¯1ï¼‰
                </div>
            </div>

            <div class="setting-group">
                <label>æ¡æ•°ï¼ˆã‚¼ãƒ­åŸ‹ã‚ï¼‰</label>
                <select id="digitPadding">
                    <option value="0">ãªã— (1, 2, 3...)</option>
                    <option value="2">2æ¡ (01, 02, 03...)</option>
                    <option value="3" selected>3æ¡ (001, 002, 003...)</option>
                    <option value="4">4æ¡ (0001, 0002, 0003...)</option>
                </select>
            </div>

            <div class="action-buttons">
                <button class="action-button primary" id="applyButton">ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’æ›´æ–°</button>
            </div>
        </div>

        <div class="file-list" id="fileList">
            <div class="info-box">
                ğŸ’¡ ãƒ•ã‚¡ã‚¤ãƒ«ã®é †ç•ªã‚’å¤‰æ›´ã™ã‚‹ã«ã¯ã€Œâ†‘ã€ã€Œâ†“ã€ãƒœã‚¿ãƒ³ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚é †ç•ªã‚’ç¢ºèªã—ãŸã‚‰ã€Œãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã€ãƒœã‚¿ãƒ³ã§ãƒªãƒãƒ¼ãƒ ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’å–å¾—ã§ãã¾ã™ã€‚
            </div>
            <h3>ğŸ“‹ ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§ï¼ˆ<span id="fileCount">0</span>ä»¶ï¼‰</h3>
            <div id="fileListContainer"></div>
            <div class="action-buttons" style="margin-top: 20px;">
                <button class="action-button primary" id="downloadAllButton">ğŸ“¦ ã™ã¹ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ (ZIP)</button>
                <button class="action-button secondary" id="resetButton">ğŸ”„ ã‚„ã‚Šç›´ã™</button>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script>
        let files = [];

        const uploadArea = document.getElementById('uploadArea');
        const pdfFilesInput = document.getElementById('pdfFiles');
        const settingsSection = document.getElementById('settingsSection');
        const fileList = document.getElementById('fileList');
        const fileListContainer = document.getElementById('fileListContainer');
        const fileCount = document.getElementById('fileCount');
        const renameMethod = document.getElementById('renameMethod');
        const prefixOptions = document.getElementById('prefixOptions');
        const patternOptions = document.getElementById('patternOptions');
        const prefix = document.getElementById('prefix');
        const customPattern = document.getElementById('customPattern');
        const customName = document.getElementById('customName');
        const startNumber = document.getElementById('startNumber');
        const digitPadding = document.getElementById('digitPadding');
        const prefixPreview = document.getElementById('prefixPreview');
        const patternPreview = document.getElementById('patternPreview');
        const applyButton = document.getElementById('applyButton');
        const downloadAllButton = document.getElementById('downloadAllButton');
        const resetButton = document.getElementById('resetButton');

        // ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        });

        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('dragover');
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            const droppedFiles = Array.from(e.dataTransfer.files).filter(f => f.type === 'application/pdf');
            if (droppedFiles.length > 0) {
                handleFiles(droppedFiles);
            }
        });

        pdfFilesInput.addEventListener('change', (e) => {
            const selectedFiles = Array.from(e.target.files);
            if (selectedFiles.length > 0) {
                handleFiles(selectedFiles);
            }
        });

        function handleFiles(selectedFiles) {
            files = selectedFiles.map((file, index) => ({
                file: file,
                originalName: file.name,
                newName: '',
                size: file.size,
                order: index
            }));

            uploadArea.style.display = 'none';
            settingsSection.style.display = 'block';
            fileList.style.display = 'block';

            updatePreview();
            renderFileList();
        }

        renameMethod.addEventListener('change', () => {
            prefixOptions.classList.remove('active');
            patternOptions.classList.remove('active');

            if (renameMethod.value === 'prefix') {
                prefixOptions.classList.add('active');
            } else if (renameMethod.value === 'pattern') {
                patternOptions.classList.add('active');
            }

            updatePreview();
        });

        prefix.addEventListener('input', updatePrefixPreview);
        customPattern.addEventListener('input', updatePatternPreview);
        customName.addEventListener('input', updatePatternPreview);
        
        applyButton.addEventListener('click', () => {
            updatePreview();
            renderFileList();
        });

        function updatePrefixPreview() {
            const p = prefix.value || 'è«‹æ±‚æ›¸_';
            const padding = parseInt(digitPadding.value);
            const start = parseInt(startNumber.value);
            
            const examples = [
                p + padNumber(start, padding) + '.pdf',
                p + padNumber(start + 1, padding) + '.pdf',
                p + padNumber(start + 2, padding) + '.pdf'
            ];
            
            prefixPreview.textContent = examples.join(', ') + '...';
        }

        function updatePatternPreview() {
            const pattern = customPattern.value || '{year}å¹´åº¦_{name}_{num}';
            const name = customName.value || 'å¥‘ç´„æ›¸';
            const padding = parseInt(digitPadding.value);
            const start = parseInt(startNumber.value);
            
            const now = new Date();
            const year = now.getFullYear();
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const date = now.getFullYear() + month + String(now.getDate()).padStart(2, '0');
            
            const examples = [1, 2, 3].map(i => {
                return pattern
                    .replace('{num}', padNumber(start + i - 1, padding))
                    .replace('{name}', name)
                    .replace('{year}', year)
                    .replace('{month}', month)
                    .replace('{date}', date) + '.pdf';
            });
            
            patternPreview.textContent = examples.join(', ') + '...';
        }

        function updatePreview() {
            const method = renameMethod.value;
            const padding = parseInt(digitPadding.value);
            const start = parseInt(startNumber.value);
            
            files.forEach((fileObj, index) => {
                const num = start + index;
                let newName = '';

                if (method === 'simple') {
                    newName = padNumber(num, padding);
                } else if (method === 'prefix') {
                    const p = prefix.value || 'file_';
                    newName = p + padNumber(num, padding);
                } else if (method === 'pattern') {
                    const pattern = customPattern.value || '{num}';
                    const name = customName.value || 'file';
                    const now = new Date();
                    const year = now.getFullYear();
                    const month = String(now.getMonth() + 1).padStart(2, '0');
                    const date = now.getFullYear() + month + String(now.getDate()).padStart(2, '0');
                    
                    newName = pattern
                        .replace('{num}', padNumber(num, padding))
                        .replace('{name}', name)
                        .replace('{year}', year)
                        .replace('{month}', month)
                        .replace('{date}', date);
                }

                fileObj.newName = newName + '.pdf';
            });

            updatePrefixPreview();
            updatePatternPreview();
        }

        function padNumber(num, padding) {
            if (padding === 0) return num.toString();
            return num.toString().padStart(padding, '0');
        }

        function renderFileList() {
            fileListContainer.innerHTML = '';
            fileCount.textContent = files.length;

            files.forEach((fileObj, index) => {
                const item = document.createElement('div');
                item.className = 'file-item';
                item.innerHTML = `
                    <div class="file-number">${index + 1}.</div>
                    <div class="file-names">
                        <div class="original-name">${fileObj.originalName}</div>
                        <div class="arrow">â†’</div>
                        <div class="new-name">${fileObj.newName}</div>
                    </div>
                    <div class="file-size">${formatFileSize(fileObj.size)}</div>
                    <div class="move-buttons">
                        <button class="move-button" onclick="moveUp(${index})" ${index === 0 ? 'disabled' : ''}>â†‘</button>
                        <button class="move-button" onclick="moveDown(${index})" ${index === files.length - 1 ? 'disabled' : ''}>â†“</button>
                    </div>
                `;
                fileListContainer.appendChild(item);
            });
        }

        window.moveUp = function(index) {
            if (index > 0) {
                [files[index], files[index - 1]] = [files[index - 1], files[index]];
                updatePreview();
                renderFileList();
            }
        };

        window.moveDown = function(index) {
            if (index < files.length - 1) {
                [files[index], files[index + 1]] = [files[index + 1], files[index]];
                updatePreview();
                renderFileList();
            }
        };

        downloadAllButton.addEventListener('click', async () => {
            const zip = new JSZip();

            files.forEach(fileObj => {
                zip.file(fileObj.newName, fileObj.file);
            });

            const zipBlob = await zip.generateAsync({type: 'blob'});
            const url = URL.createObjectURL(zipBlob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'renamed_pdfs.zip';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            alert(`${files.length}å€‹ã®PDFãƒ•ã‚¡ã‚¤ãƒ«ã‚’ZIPã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã—ãŸï¼`);
        });

        resetButton.addEventListener('click', () => {
            location.reload();
        });

        function formatFileSize(bytes) {
            if (bytes < 1024) return bytes + ' B';
            if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';
            return (bytes / (1024 * 1024)).toFixed(1) + ' MB';
        }
    </script>
</body>
</html>
